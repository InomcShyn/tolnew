(()=>{"use strict";const e={API_KEY:{key:"api_key",defaultValue:""},APP_ID:{key:"appId",defaultValue:""},POWER_ON:{key:"power_on",defaultValue:!0},TIKTOK:{key:"tiktok",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},FUNCAPTCHA:{key:"funcaptcha",defaultValue:{delayClick:100,loop:!0,isActive:!0,maxImageCaptcha:25}},ZALO:{key:"zalo",defaultValue:{delayClick:100,loop:!0,isActive:!0}},SHOPEE:{key:"shopee",defaultValue:{delaySwipe:15,loop:!0,isActive:!0}},RECAPTCHAV2:{key:"reCaptchav2",defaultValue:{delayClick:500,loop:!0,isActive:!0,useToken:!1}},AMZN:{key:"amzn",defaultValue:{delayClick:100,loop:!0,isActive:!0}},GEETEST:{key:"geetest",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},SLIDE_ALL:{key:"slide_all",defaultValue:{delaySwipe:15,loop:!0,isActive:!0}},HCAPTCHA:{key:"hcaptcha",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},CLOUDFLARE:{key:"cloudflare",defaultValue:{delayClick:2e3,isActive:!0}}};async function t(e,t,a){const n="undefined"!=typeof browser?browser.runtime:chrome.runtime;try{return await new Promise(((r,i)=>{n.sendMessage({source:e,type:t,data:a},(e=>{n.lastError?i(new Error(`Error sending message: ${n.lastError.message}`)):r(e)}))}))}catch(e){throw e}}const a=async(e,t)=>{const a="undefined"!=typeof browser?browser.storage.local:chrome.storage.local,n="undefined"!=typeof browser?browser.runtime:chrome.runtime;try{const r=await a.get([e]);if(n.lastError)throw new Error(`Error retrieving ${e}: ${n.lastError.message}`);return null!=r[e]?r[e]:t}catch(e){throw e}};Promise.resolve();async function n(e){return new Promise((t=>setTimeout(t,e)))}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=document.getElementById("captcha-message");n||(n=document.createElement("div"),n.id="captcha-message",n.style.zIndex="99999999",n.style.padding="3px 3px",n.style.borderRadius="3px",n.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.2)",n.style.fontSize="10px",n.style.fontWeight="600",n.style.fontFamily="Arial, sans-serif",n.style.textAlign="center",n.style.whiteSpace="nowrap",n.style.color="white",n.style.top="1px",a&&a.parentElement?(n.style.position="absolute",n.style.left="2px",a.parentElement.appendChild(n)):(n.style.position="fixed",n.style.left="1px",document.body.appendChild(n)));const r={success:"linear-gradient(90deg, #6a11cb,rgb(191, 37, 252))",error:"linear-gradient(90deg, #ff416c, #ff4b2b)",warning:"linear-gradient(90deg, #ff9a44, #fc6076)",info:"linear-gradient(90deg, #17a2b8, #138496)"};n.innerText="[OMOcaptcha.com] "+e,n.style.background=r[t]||r.success,n.style.display="block"}async function i(e){try{const a=await t("SOURCE","createTask",e);return a||""}catch(e){return""}}async function o(e,a,n){const r=JSON.stringify({clientKey:e,taskId:a});try{const e=await t("SOURCE","getTaskResult",{data:r,timeWait:n});return e?"fail"===e.status?{errorDescription:e.errorDescription}:e.solution?e.solution:e.type?e:null:null}catch(e){return null}}let c,s,l,d,u;let f=!1,p=[];async function y(){var e="";let t=document.querySelector('[role="dialog"] [id*="captchaMask"]');r("Captcha slide","red",t);for(var a=0;a<30;a++){r("Get image...","red",t),await n(1e3);var c=document.querySelector('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(1) > img');if(c&&e!==c.src){e=c.src;var l=document.querySelector('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(2) > img');r("Create task...","red",t);const a=JSON.stringify({clientKey:s,task:{type:"ShopeeSliderWebTask",typeCaptcha:"",imageBase64s:[l.src,e]}}),n=await i(a);if(!n||n.error){if(r(n?n.errorDescription:"No response","red",t),d){await w(l,1);continue}return}{r("Get result...","red",t);const a=await o(s,n.taskId,30);if(!a||a.errorDescription){e="";if(r(a?a.errorDescription:"No result from API","red",t),d){await w(l,1);continue}return}let i=parseInt(a.end.x,10);if(r("Solving...","red",t),await w(l,i),!d)return}}}}async function h(){var e="";let t=document.querySelector('[id*="NEW_CAPTCHA"] [id*="captchaMask"]');r("Captcha slide new","red",t);for(var a=0;a<30;a++){r("Get image...","red",t),await n(600+800*Math.random());const a=document.querySelector('[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(1) > img'),c=document.querySelector('[id*="sliderContainer"]'),l=document.querySelector('[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(2) > img');if(a&&c&&l&&e!==a.src){e=a.src,r("Create task...","red",t);const u=JSON.stringify({clientKey:s,task:{type:"ShopeeSliderWebTask",typeCaptcha:"rotate",imageBase64s:[l.src,e]}}),f=await i(u);if(!f||f.error){if(r(f?f.errorDescription:"No response","red",t),d)continue;return}p.push(f.taskId),r("Get result...","red",t);const y=await o(s,f.taskId,30);if(!y||y.errorDescription){e="";if(r(y?y.errorDescription:"No result from API","red",t),d)continue;return}if(!y.point||!y.point.x||!y.point.y){if(d)continue;return}let h=parseFloat(y.point.x),m=parseFloat(y.point.y);const g=a.getBoundingClientRect(),w=g.width/a.naturalWidth,E=g.height/a.naturalHeight,C=g.left+h*w,A=g.top+m*E;if(r("Solving...","red",t),await v(c,l,C,A),await n(3e3),location.href.includes("/verify/captcha?anti_bot_tracking_id")&&await k(!1),!d)return}}}function m(e){return!!document.querySelector(e)}async function g(e,t){const a=Date.now()+t;for(;Date.now()<a;){for(const t of e){if(document.querySelector(t))return!0}await n(500)}return!1}function w(e,t){return new Promise(((a,n)=>{if(!e)return void n("Element not found");function r(){const t=e.getBoundingClientRect();return{centerX:t.left+t.width/2,centerY:t.top+t.height/2}}const i=new DataTransfer;function o(t,a,n){const r={bubbles:!0,cancelable:!0,clientX:a,clientY:n,dataTransfer:i,...arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}},o=t.includes("drag")?new DragEvent(t,r):new MouseEvent(t,r);e.dispatchEvent(o)}const c=r(),s=c.centerX+t;o("pointerenter",c.centerX,c.centerY),o("mouseover",c.centerX,c.centerY),o("mousedown",c.centerX,c.centerY),o("dragstart",c.centerX,c.centerY);let l=c.centerX,d=10,u=3;!function e(){const n=r();if(Math.abs(n.centerX-s)<=1)return void setTimeout((()=>{o("dragend",n.centerX,n.centerY),o("mouseup",n.centerX,n.centerY),a()}),1e3);s-n.centerX>t/4?(d=10,u=3):(d=1,u=10),l+=d*Math.sign(s-n.centerX);const i=n.centerY;o("mousemove",l,i),o("drag",l,i),setTimeout(e,u)}()}))}async function v(e,t,a,n){if(!e||!t)return;function r(e){const t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}const i=e=>new Promise((t=>setTimeout(t,e))),o=new DataTransfer;function c(t,a,n){const r=t.includes("drag")?new DragEvent(t,{bubbles:!0,cancelable:!0,clientX:a,clientY:n,dataTransfer:o}):new MouseEvent(t,{bubbles:!0,cancelable:!0,clientX:a,clientY:n});e.dispatchEvent(r)}const s=r(e);c("pointerenter",s.x,s.y),c("mouseover",s.x,s.y),await i(50+150*Math.random()),c("mousedown",s.x,s.y),c("dragstart",s.x,s.y);let l=s.x,d=s.y,u=1,f=0;for(;;){const e=r(t),o=a-e.x,s=n-e.y,p=Math.sqrt(o*o+s*s);if(1===u&&p<5){const e=50;l+=o/p*e,d+=s/p*e,c("mousemove",l,d),c("drag",l,d),u=2,await i(10+20*Math.random());continue}if(2===u){const e=-50;l+=o/p*e,d+=s/p*e,c("mousemove",l,d),c("drag",l,d),u=3,await i(10+20*Math.random());continue}if(3===u&&p<3){l+=o,d+=s,c("mousemove",l,d),c("drag",l,d);break}let y;y=p>50?6+1.5*Math.random():p>20?3+1*Math.random():1.5+.5*Math.random();const h=.5+Math.random(),m=Math.sin(f/300*Math.PI)*h*5;if(l+=o/p*y+.5*(Math.random()-.5),d+=s/p*y+m+.5*(Math.random()-.5),c("mousemove",l,d),c("drag",l,d),f%10==0&&Math.random()<1){c("mousemove",l+4*(Math.random()-.5),d+4*(Math.random()-.5)),await i(10+30*Math.random())}let g;if(g=p>50?10+10*Math.random():10+20*Math.random(),await i(g),f++,f>300)break}await i(10+50*Math.random()),c("dragend",l,d),c("mouseup",l,d)}async function k(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0===p.length)return;const a={taskIds:p,result:e};try{await t("SHOPEE","reportTask",a)}catch(e){}finally{p=[]}}new MutationObserver((async(e,t)=>{await async function(e){if(c&&u&&s&&"YOUR_CLIEN_KEY"!==s)for(const t of e)if("childList"===t.type){const e=document.querySelector('[role="dialog"] [id*="captchaMask"]'),t=document.querySelector('[id*="NEW_CAPTCHA"] [id*="captchaMask"]');if(e||t){if(!f){if(!s)return;f=!0,await n(1e3),g(['[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(1) > img','[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(2) > img','[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(1) > img','[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(2) > img'],1e4).then((async e=>{if(e)for(var t=0;t<20;t++){if(m('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(1) > img')&&m('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(2) > img')){await y();break}if(m('[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(1) > img')&&m('[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(2) > img')){await h();break}await n(500)}}))}}else f=!1}}(e)})).observe(document.body,{childList:!0,subtree:!0}),(async()=>{await async function(){c=await a(e.POWER_ON.key,e.POWER_ON.defaultValue),s=await a(e.API_KEY.key,e.API_KEY.defaultValue);const t=await a(e.SHOPEE.key,e.SHOPEE.defaultValue);l=t.delaySwipe,d=t.loop,u=t.isActive}()})()})();